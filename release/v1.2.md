# Release v1.2

Date: 2026-02-16  
Branch: `release/v1.2`

## Summary
v1.2 focuses on production-safe Hyperliquid operation: deterministic risk controls, more reliable autonomous execution, and collateral movement tools that handle real account balance edge cases.

## What Was Delivered

1. Risk controls promoted to branch baseline
- Merged position heartbeat work (background trigger loop + emergency close pathways).
- Merged trade-management risk controls (deterministic monitor + bracket lifecycle foundation).

2. Autonomous execution reliability fixes
- Fixed trade-mode detection and dynamic-input issues that blocked autonomous execution.
- Fixed GPT tool-name fuzzy/mangled resolution path.
- Allowed reduce-only close orders to bypass spending-limiter rejection.
- Improved fallback behavior by routing to orchestrator when autonomous scan returns no candidates.

3. Better trade-intent context
- Trade-intent path now includes live `perp_market_list` snapshot to ground tool selection.

4. Hyperliquid collateral and transfer operations
- Added `hyperliquid_usd_class_transfer` to the core tool layer.
- Exposed `hyperliquid_usd_class_transfer` in agent adapters for orchestrated tool use.
- Added dex-abstraction detection and unified-collateral handling:
  - when unified, spot USDC is treated as collateral
  - when perp withdrawable is `0`, system falls back to spot USDC balance
- Clarified spot/perp/on-chain USDC semantics in portfolio output.

5. Test coverage additions
- Added/updated tests for:
  - trade-intent tool snapshot behavior
  - Hyperliquid USD class transfer tool
  - dex-abstraction collateral edge cases

## Key Commits Included
- `79bcf21` Hyperliquid: fall back to spot USDC when perp withdrawable is 0
- `54ae313` Hyperliquid: detect dex abstraction and treat spot USDC as collateral when unified
- `17a232d` Agent tools: expose hyperliquid_usd_class_transfer
- `b2cc1ad` Hyperliquid: add usdClassTransfer tool + clarify spot/perp/onchain USDC in get_portfolio
- `86bfe47` Conversation: include perp_market_list snapshot on trade intent
- `357bfc9` Fall through to orchestrator when autonomous scan finds nothing
- `462eb54` Fix three bugs preventing autonomous trade execution
- `0884bbf` Fix GPT tool name mangling with substring extraction
- `6036ae3` Perps: bypass spending limiter for reduce-only orders
- `df821b4` v1.2: start trade management risk controls (HL brackets + monitor)
- `d395094` v1.2: add position heartbeat service (emergency close + triggers)

## Operational Follow-Up
1. Deploy `release/v1.2` to server and restart gateway/service.
2. Run live verification:
- `hyperliquid_verify_live`
- `hyperliquid_order_roundtrip`
- `hyperliquid_usd_class_transfer` (tiny amount)
3. Validate heartbeat and trade-monitor behavior on a minimal live position.
