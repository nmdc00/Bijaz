# Release v1.5 Planner

Date: 2026-02-17  
Base Branch: `develop`  
Release Branch: `release/v1.5`

## Scope Guardrails

- One feature branch per task, one PR per branch.
- Preserve v1.4 behavior unless explicitly changed by v1.5 tasks.
- Keep deterministic policy gates as final execution authority.
- Ship feedback/labeling infrastructure before heavy microstructure complexity.

## Task Branch Strategy

1. `feat/v1.5-decision-labeling-foundation`
2. `feat/v1.5-regime-stress-tagging`
3. `feat/v1.5-counterfactual-pnl-engine`
4. `feat/v1.5-playbook-runtime-foundation`
5. `feat/v1.5-native-conditional-exits`
6. `feat/v1.5-portfolio-risk-baskets`
7. `feat/v1.5-derivatives-state-ingestion`
8. `feat/v1.5-microstructure-flow-features`
9. `feat/v1.5-cross-venue-leadlag`
10. `feat/v1.5-execution-telemetry`
11. `feat/v1.5-integration-acceptance-tests`

## Tasks

## 1) Decision Labeling Foundation
Branch: `feat/v1.5-decision-labeling-foundation`

Deliverables:
- Add trade decision labels: direction/timing/sizing/exit quality.
- Persist structured labels with reasoning metadata.

Acceptance criterion:
- Every closed trade has a valid label record.

Test requirement:
- Unit tests for label schema and write/read paths.

## 2) Regime and Stress Tagging
Branch: `feat/v1.5-regime-stress-tagging`

Deliverables:
- Add deterministic regime, volatility, and stress tags at decision time.
- Attach tags to trade and scan artifacts.

Acceptance criterion:
- Decision records include non-null regime/stress tags.

Test requirement:
- Table-driven tests across representative market states.

## 3) Counterfactual PnL Engine
Branch: `feat/v1.5-counterfactual-pnl-engine`

Deliverables:
- Compute deterministic counterfactual outcomes for alternate hold/exit/size paths.
- Store replay metadata and summary deltas vs realized outcome.

Acceptance criterion:
- Counterfactual outputs are generated for at least one closed-trade fixture set.

Test requirement:
- Fixture tests for alternate-path PnL correctness.

## 4) Playbook Runtime Foundation
Branch: `feat/v1.5-playbook-runtime-foundation`

Deliverables:
- Add parameterized playbook registry and scheduler integration.
- Support enable/disable, cooldown, and replay-safe state transitions.

Acceptance criterion:
- Playbooks run continuously under scheduler without duplicate execution.

Test requirement:
- Runtime tests for state transitions and cooldown enforcement.

## 5) Native Conditional and Time Exits
Branch: `feat/v1.5-native-conditional-exits`

Deliverables:
- Add bracket/time-based exit primitives and policy-safe wiring.
- Add deterministic trigger evaluation and reason logging.

Acceptance criterion:
- Bracket/time exit triggers execute as configured in fixture scenarios.

Test requirement:
- Unit/integration tests for trigger evaluation and execution handoff.

## 6) Portfolio Risk Baskets
Branch: `feat/v1.5-portfolio-risk-baskets`

Deliverables:
- Add basket-level leverage/exposure constraints.
- Add regime-aware cap selection and policy reason codes.

Acceptance criterion:
- Configured basket cap breaches are blocked with explicit reasons.

Test requirement:
- Policy tests for basket caps and regime variants.

## 7) Derivatives State Ingestion
Branch: `feat/v1.5-derivatives-state-ingestion`

Deliverables:
- Ingest high-resolution funding/OI/liquidation/skew snapshots.
- Persist time-indexed state for downstream features.

Acceptance criterion:
- State feed populates expected fields on supported symbols.

Test requirement:
- Adapter tests for parsing, normalization, and missing-data fallback.

## 8) Microstructure Flow Features
Branch: `feat/v1.5-microstructure-flow-features`

Deliverables:
- Add depth/flow feature extraction (imbalance, sweep-pressure proxies).
- Expose features in context packs and execution diagnostics.

Acceptance criterion:
- Feature vectors are available in decision context for enabled symbols.

Test requirement:
- Deterministic feature-calculation tests from canned market snapshots.

## 9) Cross-Venue Lead/Lag
Branch: `feat/v1.5-cross-venue-leadlag`

Deliverables:
- Add cross-venue market adapters and normalized comparative signals.
- Add lead-lag/divergence metrics for configured venue pairs.

Acceptance criterion:
- Lead-lag signal computes successfully for at least one configured pair.

Test requirement:
- Adapter + signal tests against fixture data.

## 10) Execution Telemetry
Branch: `feat/v1.5-execution-telemetry`

Deliverables:
- Persist latency, slippage, maker/taker outcome, and fill-quality metrics.
- Add telemetry summary reports for strategy attribution.

Acceptance criterion:
- Every executed order has telemetry records with required fields.

Test requirement:
- Execution-path tests for telemetry capture and report aggregation.

## 11) Integration and Acceptance Harness
Branch: `feat/v1.5-integration-acceptance-tests`

Deliverables:
- Add end-to-end acceptance coverage across labeling, counterfactuals, playbooks, and risk baskets.
- Add v1.5 smoke script/checklist updates.

Acceptance criterion:
- Full v1.5 acceptance suite passes on `release/v1.5`.

Test requirement:
- Deterministic integration suite with fixtures for full trade lifecycle + replay.

## Merge Order

1. `feat/v1.5-decision-labeling-foundation`
2. `feat/v1.5-regime-stress-tagging`
3. `feat/v1.5-counterfactual-pnl-engine`
4. `feat/v1.5-playbook-runtime-foundation`
5. `feat/v1.5-native-conditional-exits`
6. `feat/v1.5-portfolio-risk-baskets`
7. `feat/v1.5-derivatives-state-ingestion`
8. `feat/v1.5-microstructure-flow-features`
9. `feat/v1.5-cross-venue-leadlag`
10. `feat/v1.5-execution-telemetry`
11. `feat/v1.5-integration-acceptance-tests`

## Exit Criteria for v1.5

- All v1.5 task branches merged into `release/v1.5`.
- Labeling + regime/stress tags are present on closed trades.
- Counterfactual analytics are queryable for closed trade fixtures.
- Automated playbooks run continuously with policy-compliant behavior.
- Portfolio basket risk caps enforce configured constraints.
- v1.5 acceptance and smoke checks are green.
